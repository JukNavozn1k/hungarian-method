import streamlit as st
from hungarian import hungarian
st.set_page_config(
    page_title="–í–µ–Ω–≥–µ—Ä—Å–∫–∏–π –º–µ—Ç–æ–¥",
    page_icon="üßÆ",  # –≠–º–æ–¥–∑–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
)
def parse_matrix(inputs, size):
    """
    –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–∞–Ω–Ω—ã—Ö.
    """
    try:
        matrix = [
            [float(inputs[f"cell_{i}_{j}"]) for j in range(size)]
            for i in range(size)
        ]
        return matrix
    except ValueError:
        st.error("–û—à–∏–±–∫–∞: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏.")
        return None

st.title("–í–µ–Ω–≥–µ—Ä—Å–∫–∏–π –º–µ—Ç–æ–¥")


tab1, tab2 = st.tabs(["–†–∞—Å—Å—á–∏—Ç–∞—Ç—å", "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è"])

with tab1:
    st.write("""
    –≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ –í–µ–Ω–≥–µ—Ä–∞.
    –£–∫–∞–∂–∏—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º (–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∏–ª–∏ –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è) –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å".
    """)

    # –í–≤–æ–¥ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
    size = st.number_input("–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã (1-10):", min_value=1, max_value=10, step=1, value=3)

    # –í–≤–æ–¥ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã
    st.write("–í–≤–µ–¥–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã:")
    inputs = {}
    for i in range(size):
        cols_container = st.columns(size)  # Create columns for each element in the row
        for j in range(size):
            key = f"cell_{i}_{j}"
            placeholder = f"{i+1},{j+1}" # –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            inputs[key] = cols_container[j].text_input(f"({i+1}, {j+1})", key=key, placeholder=placeholder, label_visibility="collapsed")

    # –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
    maximize = st.checkbox("–†–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –Ω–∞ –º–∞–∫—Å–∏–º—É–º", value=False)

    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    if st.button("–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"):
        cost_matrix = parse_matrix(inputs, size)
        if cost_matrix:
            try:
                assignment, total_cost = hungarian(cost_matrix, maximize=maximize)
                st.success("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
                st.write(f"–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è: {assignment}")
                st.write(f"–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: {total_cost}")
            except ValueError as e:
                st.error(f"–û—à–∏–±–∫–∞: {e}")

with tab2:
    st.write("""
    **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
    
    1. –£–∫–∞–∂–∏—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã (–æ—Ç 1 –¥–æ 10).
    2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã, –≤–≤–æ–¥—è —á–∏—Å–ª–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è.
    3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:
       - –û—Å—Ç–∞–≤—å—Ç–µ —Ñ–ª–∞–∂–æ–∫ –ø—É—Å—Ç—ã–º –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏.
       - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–∂–æ–∫ –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏.
    4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å".
    5. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –Ω–∏–∂–µ, –≤–∫–ª—é—á–∞—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∏ –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å.
    """)